<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>FERC | Flat Earth Rocket Corporation</title>

    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700;900&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --accent: #bfff00;
            --bg: #000000;
            --surface: #0a0a0a;
            --text: #ffffff;
            --text-dim: #9a9a9a;
            --line: #1a1a1a;
        }

        html { scroll-behavior: smooth; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body::before {
            content: "";
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://grainy-gradients.vercel.app/noise.svg');
            opacity: 0.04; pointer-events: none; z-index: 9999;
        }
        body { background-color: var(--bg); color: var(--text); line-height: 1.4; overflow-x: hidden; }

        .mono { font-family: 'JetBrains Mono', monospace; color: var(--accent); font-size: 0.65rem; letter-spacing: 2px; display: block; margin-bottom: 5px; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: var(--accent); }

        .page { display: none; min-height: 100vh; }
        .page.active { display: block; }

        .fade-in { opacity: 0; transform: translateY(30px); transition: all 1s cubic-bezier(0.2,0.6,0.2,1); }
        .fade-in.visible { opacity: 1; transform: translateY(0); }

        nav { position: fixed; top: 0; width: 100%; padding: 22px 46px; display: flex; justify-content: space-between; align-items: center; z-index: 1000; background: rgba(0,0,0,0.85); backdrop-filter: blur(6px); border-bottom: 1px solid rgba(255,255,255,0.03); }
        .logo { font-weight: 900; font-size: 1.15rem; letter-spacing: 2px; cursor: pointer; }
        .logo span { color: var(--accent); }

        .nav-links { display:flex; gap: 30px; }
        .nav-links a { text-decoration:none; color: #ddd; font-size:0.75rem; font-weight:700; text-transform:uppercase; letter-spacing:2px; cursor:pointer; }
        .nav-links a.active, .nav-links a:hover { color: var(--accent); }

        .timer-box { border: 1px solid rgba(255,255,255,0.03); padding:8px 14px; display:flex; flex-direction:column; align-items:flex-end; background: rgba(10,10,10,0.6); border-radius:6px; }
        .timer-label { font-size: 0.55rem; letter-spacing: 2px; color: var(--accent); font-weight:700; }
        .timer-value { font-size: 0.95rem; font-weight:900; font-variant-numeric: tabular-nums; }

        .hero { height: 100vh; display:flex; flex-direction:column; justify-content:center; padding: 0 10%; background: radial-gradient(circle at 20% 50%, #111 0%, #000 100%); }
        .hero h1 { font-size: clamp(3rem, 12vw, 7.5rem); font-weight:900; line-height:0.9; letter-spacing:-2px; }

        .status-quo { padding: 120px 10%; background: var(--surface); border-top: 1px solid rgba(255,255,255,0.02); border-bottom: 1px solid rgba(255,255,255,0.02); }
        .status-quo h2 { font-size: clamp(1.6rem, 4vw, 2.4rem); color: var(--text-dim); font-weight:900; }

        .rocket-viewer-section { min-height: 80vh; display:flex; align-items:center; padding: 60px 10%; }
        .info-panel { flex:1; padding-right:40px; }
        .model-container { flex:1.2; height: 70vh; position:relative; }
        model-viewer { width:100%; height:100%; }

        /* GRID & CARDS */
        .grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 18px; }
        .card { background: transparent; padding: 28px 20px; transition:0.3s; border-radius:8px; display:flex; flex-direction:column; align-items:center; text-align:center; }
        .card h3 { color: var(--accent); margin: 10px 0; font-size:1.05rem; }
        .price { font-family: 'JetBrains Mono'; color: var(--accent); font-size:1.25rem; margin:8px 0; }
        .btn-shop { background: var(--accent); color: #000; border:none; padding:10px 16px; font-weight:900; text-transform:uppercase; letter-spacing:1px; border-radius:6px; cursor:pointer; }

        /* Product thumbnails cleansed */
        .product-thumb { height: 320px; background: transparent; border: none; margin-bottom: 10px; position: relative; overflow: hidden; display:flex; align-items:center; justify-content:center; cursor:pointer; }
        .product-thumb img { width:auto; height:100%; object-fit:contain; transform:scale(1.05); transition: transform 300ms ease; }
        .product-thumb:hover img { transform:scale(1.08); }
        .product-thumb .img-back { display:none !important; }

        /* Product page */
        .product-page { padding: 120px 10% 100px; }
        .product-hero { display:flex; gap:36px; align-items:flex-start; }
        .big-image { flex:1; background:transparent; border:none; height:560px; display:flex; align-items:center; justify-content:center; overflow:hidden; }
        .big-image img { max-width:110%; max-height:100%; object-fit:contain; transform:scale(1.02); }
        .product-info { flex:1; padding:8px 0; }
        .back-link { background:transparent; border:1px solid rgba(255,255,255,0.03); color:var(--text-dim); padding:8px 12px; cursor:pointer; border-radius:6px; margin-bottom:18px; }

        /* Charts panel */
        .chart-panel { margin-top:18px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:10px; padding:18px; box-shadow: 0 6px 30px rgba(0,0,0,0.6); }
        .chart-row { display:flex; gap:16px; align-items:stretch; }
        .chart-large { flex:2; position:relative; height:300px; }
        .chart-small { flex:1; min-width:260px; position:relative; height:300px; }
        .chart-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; }
        .chart-header h4 { margin:0; color:var(--text); font-size:1rem; }
        .chart-actions { display:flex; gap:8px; }
        .small-btn { background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--text-dim); padding:6px 10px; border-radius:6px; cursor:pointer; font-size:0.85rem; }

        footer { padding: 50px 10%; border-top:1px solid rgba(255,255,255,0.03); color:var(--text-dim); font-size:0.75rem; text-align:center; }

        @media (max-width: 1024px) { .product-hero { flex-direction:column; } .big-image { height:360px; } .chart-row { flex-direction:column; } }
    </style>
</head>
<body>

    <nav>
        <div class="logo" onclick="switchPage('home')">FERC<span>.</span></div>
        <div class="nav-links">
            <a onclick="switchPage('home')" id="link-home" class="active">The Leveler</a>
            <a onclick="switchPage('missions')" id="link-missions">Missions</a>
            <a onclick="switchPage('shop')" id="link-shop">Shop</a>
        </div>
        <div class="timer-box">
            <span class="timer-label">UPCOMING LAUNCH</span>
            <span id="countdown" class="timer-value">T-00:00:00:00</span>
        </div>
    </nav>

    <!-- HOME (same as before) -->
    <div id="page-home" class="page active">
        <header class="hero">
            <span class="mono fade-in">[INITIATING_CORE_SYSTEMS]</span>
            <h1 class="fade-in">Flat Earth<br>Rocket<br><span style="color: var(--accent);">Corp</span></h1>
        </header>

        <section class="status-quo">
            <div class="fade-in">
                <span class="mono">[MANIFESTO_v1.0]</span>
                <h2>Kwestionujemy <span style="color: white;">status quo</span> poprzez fizykę, a nie teorie.</h2>
            </div>
        </section>

        <section class="rocket-viewer-section">
            <div class="info-panel fade-in">
                <span class="mono">[SYSTEM_SPECIFICATIONS]</span>
                <h2 style="font-size:2.8rem; margin:12px 0;">The Leveler</h2>
                <div class="spec-item"><span class="spec-label">Pułap docelowy</span><span><span class="stat-count" data-target="250000">0</span> FT</span></div>
            </div>
            <div class="model-container">
                <model-viewer src="rakieta.glb" auto-rotate rotation-speed="40deg" shadow-intensity="2" exposure="1.2"></model-viewer>
            </div>
        </section>

        <section class="grid" style="padding:40px 10px 80px;">
            <div class="card fade-in">
                <span class="mono">TECH_CORE</span>
                <h3>Silniki Klasy G</h3>
                <p style="color:var(--text-dim);">Autorski napęd wysokoprężny.</p>
            </div>
            <div class="card fade-in">
                <span class="mono">MODULE_02</span>
                <h3>Sensory</h3>
                <p style="color:var(--text-dim);">Mechanika bezwładnościowa.</p>
            </div>
            <div class="card fade-in">
                <span class="mono">MODULE_03</span>
                <h3>Dane</h3>
                <p style="color:var(--text-dim);">Surowy zapis z sensorów.</p>
            </div>
        </section>
    </div>

    <!-- MISSIONS (unchanged) -->
    <div id="page-missions" class="page">
        <section style="padding:140px 10% 80px;">
            <span class="mono">[STRATEGIC_OPERATIONS]</span>
            <h1 style="font-size:2.8rem; margin-bottom:30px;">Operations</h1>
            <div class="grid">
                <div class="card fade-in"><span class="mono">FLAGSHIP_PROJECT</span><h3>Rocket Simon</h3><p style="color:var(--text-dim);">Największa jednostka w historii FERC.</p></div>
                <div class="card fade-in"><span class="mono">ENGINEERING_DEPT</span><h3>Silniki Klasy G</h3><p style="color:var(--text-dim);">Nowa generacja silników.</p></div>
                <div class="card fade-in"><span class="mono">MISSION_03</span><h3>Ice Wall Recon</h3><p style="color:var(--text-dim);">Długodystansowy lot.</p></div>
            </div>
        </section>
    </div>

    <!-- SHOP MAIN -->
    <div id="page-shop" class="page">
        <section style="padding:120px 10% 80px;">
            <span class="mono">[COMMERCIAL_UNIT]</span>
            <h1 style="font-size:2.6rem; margin-bottom:20px;">Gear</h1>
            <div class="grid">
                <!-- Bluza -->
                <div class="card fade-in">
                    <div class="product-thumb" role="button" tabindex="0" onclick="openProduct('bluza')" onkeydown="if(event.key==='Enter') openProduct('bluza')">
                        <img class="img-front" src="bluza_przod.png" alt="Beyond the Curve - przód" draggable="false">
                    </div>
                    <h3>Beyond the Curve Hoodie</h3>
                    <span class="price">249 PLN</span>
                    <button class="btn-shop" onclick="openProduct('bluza')">Buy Gear</button>
                </div>

                <!-- Silnik -->
                <div class="card fade-in">
                    <div class="product-thumb" role="button" tabindex="0" onclick="openProduct('engine')" onkeydown="if(event.key==='Enter') openProduct('engine')">
                        <img class="img-front" src="g_motor.png" alt="G-Class Engine - front" draggable="false">
                    </div>
                    <h3>G-Class Engine Scale Model</h3>
                    <span class="price">599 PLN</span>
                    <button class="btn-shop" onclick="openProduct('engine')">Pre-order</button>
                </div>
            </div>
        </section>
    </div>

    <!-- PRODUCT: BLUZA -->
    <div id="page-shop-bluza" class="page">
        <section class="product-page">
            <div style="max-width:1200px; margin:0 auto;">
                <button class="back-link" onclick="switchPage('shop')">← Powrót do sklepu</button>
                <div class="product-hero fade-in">
                    <div class="big-image"><img id="bluza-big" src="bluza_przod.png" alt="Beyond the Curve - produkt"></div>
                    <div class="product-info">
                        <span class="mono">[PRODUCT]</span>
                        <h2>Beyond the Curve Hoodie</h2>
                        <div class="price">249 PLN</div>
                        <p style="color:var(--text-dim);">Wysokiej jakości bawełniana bluza z haftem FERC.</p>
                        <div style="display:flex; gap:10px; margin-top:16px;"><button class="btn-shop" onclick="addToCart('bluza')">Dodaj do koszyka</button></div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- PRODUCT: ENGINE (z wykresami) -->
    <div id="page-shop-engine" class="page">
        <section class="product-page">
            <div style="max-width:1200px; margin:0 auto;">
                <button class="back-link" onclick="switchPage('shop')">← Powrót do sklepu</button>
                <div class="product-hero fade-in">
                    <div class="big-image">
                        <img id="engine-big" src="g_motor.png" alt="G-Class Engine - produkt">
                    </div>
                    <div class="product-info">
                        <span class="mono">[PRODUCT]</span>
                        <h2>G-Class Engine Scale Model</h2>
                        <div class="price">599 PLN</div>
                        <p style="color:var(--text-dim);">Model silnika w skali, pre-order.</p>
                        <div style="display:flex; gap:12px; margin-top:16px;">
                            <button class="btn-shop" onclick="addToCart('engine')">Dodaj do koszyka</button>
                            <button class="btn-shop" onclick="window.alert('Symulacja zakupu — tu zaintegrujesz checkout')">Kup teraz</button>
                        </div>

                        <!-- Chart area -->
                        <div class="chart-panel" id="engine-charts">
                            <div class="chart-header">
                                <h4>Wykres osiągów: ciąg [N] vs czas [s]</h4>
                                <div class="chart-actions">
                                    <button class="small-btn" id="downloadCSV">Pobierz CSV</button>
                                    <button class="small-btn" id="resetZoom">Reset zoom</button>
                                </div>
                            </div>
                            <div class="chart-row">
                                <div class="chart-large">
                                    <canvas id="thrustChart" height="260"></canvas>
                                </div>
                                <div class="chart-small">
                                    <div style="margin-bottom:8px;"><strong style="color:var(--text-dim);">Zoom (1.0 - 3.0 s)</strong></div>
                                    <canvas id="thrustZoom" height="260"></canvas>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </section>
    </div>

    <footer>&copy; 2026 FLAT EARTH ROCKET CORPORATION. BEYOND THE CURVE.</footer>

    <script>
        // --- basic page & animation utilities (as before) ---
        function switchPage(pageName) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-links a').forEach(a => a.classList.remove('active'));
            if (pageName === 'home' || pageName === 'missions' || pageName === 'shop') {
                const link = document.getElementById('link-' + pageName);
                if (link) link.classList.add('active');
            }
            const el = document.getElementById('page-' + pageName);
            if (el) el.classList.add('active');
            window.scrollTo(0,0);
            refreshAnimations();
            // if engine page -> init charts
            if (pageName === 'shop-engine') {
                // small delay to ensure canvas is rendered
                setTimeout(initEngineCharts, 80);
            }
        }

        function openProduct(key) {
            if (key === 'bluza') switchPage('shop-bluza');
            else if (key === 'engine') switchPage('shop-engine');
        }

        function addToCart(item) { window.alert('Dodano do koszyka: ' + (item==='bluza' ? 'Beyond the Curve Hoodie' : 'G-Class Engine Scale Model')); }

        // fade-in observer
        function refreshAnimations() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('visible'); });
            }, { threshold: 0.1 });
            document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));
        }
        refreshAnimations();

        // countdown (unchanged)
        function updateCountdown() {
            const targetDate = new Date(2026,5,21).getTime();
            const now = Date.now();
            const d = Math.max(0, targetDate - now);
            const days = String(Math.floor(d / (1000*60*60*24))).padStart(2,'0');
            const hours = String(Math.floor((d % (1000*60*60*24)) / (1000*60*60))).padStart(2,'0');
            const mins = String(Math.floor((d % (1000*60*60)) / (1000*60))).padStart(2,'0');
            const secs = String(Math.floor((d % (1000*60)) / 1000)).padStart(2,'0');
            document.getElementById('countdown').textContent = `T-${days}:${hours}:${mins}:${secs}`;
        }
        setInterval(updateCountdown, 1000); updateCountdown();

        // --- ENGINE CHARTS ---
        // CSV data (provided) - "Czas [s],N" rows
        const thrustCSV = `Czas [s],N
0.000,-0.072
0.050,-0.071
0.100,-0.079
0.167,-0.107
0.257,-0.103
0.348,-0.086
0.438,-0.080
0.528,-0.074
0.619,-0.068
0.708,-0.054
0.799,-0.033
0.890,-0.005
0.979,0.029
1.069,0.084
1.160,0.178
1.250,0.291
1.340,2.465
1.431,14.262
1.520,26.856
1.611,38.976
1.702,52.110
1.791,63.715
1.881,69.842
1.972,71.149
2.062,70.430
2.152,69.087
2.243,66.300
2.332,61.406
2.423,51.966
2.514,33.503
2.603,13.546
2.693,3.867
2.784,1.135
2.874,0.293
2.964,0.332
3.055,0.484
3.144,0.629
3.235,0.716
3.326,0.723
3.415,0.705
3.505,0.717
3.596,0.739
3.686,0.761
3.776,0.784
3.867,0.807
3.956,0.828
4.047,0.843
4.138,0.859
4.227,0.884
4.317,0.903
4.408,0.901
4.498,0.896
4.588,0.899
4.679,0.897
4.768,0.891
4.858,0.885
4.950,0.880
5.039,0.875
5.129,0.868
5.220,0.862
5.310,0.857
5.400,0.857
5.491,0.865
5.580,0.868
5.670,0.867
5.762,0.869
5.851,0.873
5.941,0.878
6.032,0.879
6.122,0.878
6.212,0.876
6.303,0.878
6.392,0.881
6.482,0.883
6.574,0.883
6.663,0.881
6.753,0.877
6.844,0.874
6.934,0.871
7.024,0.866
7.115,0.859
7.204,0.855
7.294,0.853
7.386,0.857
7.475,0.856
7.565,0.850
7.656,0.844
7.746,0.838
7.836,0.832
7.927,0.824
8.016,0.815
8.106,0.804
8.198,0.795
8.287,0.790
8.377,0.786
8.468,0.783
8.558,0.779
8.648,0.774
8.739,0.768
8.828,0.759
8.918,0.750
9.010,0.745
9.099,0.742
9.189,0.738
9.280,0.730
9.370,0.719
9.460,0.709
9.551,0.697
9.640,0.689
9.730,0.683
9.822,0.678
9.911,0.677
10.001,0.678
10.092,0.674
10.182,0.669
10.272,0.661
10.363,0.651
10.452,0.643
10.542,0.631
10.634,0.620
10.723,0.613
10.813,0.606
10.904,0.596
10.994,0.587
11.084,0.583
11.175,0.578
11.264,0.571
11.354,0.562
11.446,0.553
11.535,0.543
11.625,0.536
11.716,0.528
11.806,0.524
11.896,0.523
11.987,0.518
12.076,0.511
12.166,0.503
12.258,0.495
12.347,0.489
12.437,0.489
12.528,0.487
12.618,0.483
12.708,0.482
12.799,0.477
12.888,0.474
12.978,0.471
13.070,0.468
13.159,0.466
13.249,0.464
13.340,0.461
13.430,0.455
13.520,0.455
13.611,0.460
13.700,0.462
13.791,0.461
13.882,0.461
13.971,0.457
14.061,0.454
14.152,0.453
14.242,0.449
14.332,0.440
14.423,0.430
14.512,0.424
14.603,0.419
14.694,0.412
14.783,0.401
14.873,0.388
14.964,0.370
15.054,0.351
15.144,0.337
15.235,0.321
15.324,0.302
15.415,0.279
15.506,0.250
15.595,0.214
15.685,0.172
15.776,0.134
15.866,0.099
15.956,0.068
16.047,0.038
16.136,-0.001`;

        // Parse CSV into arrays
        function parseCSV(csv) {
            const lines = csv.trim().split(/
?
/).filter(Boolean);
            const data = [];
            for (let i = 1; i < lines.length; i++) {
                const parts = lines[i].split(',');
                const t = parseFloat(parts[0]);
                const v = parseFloat(parts[1]);
                if (!isNaN(t) && !isNaN(v)) data.push({t, v});
            }
            return data;
        }

        let mainChart = null;
        let zoomChart = null;
        let engineData = null;

        function initEngineCharts() {
            if (mainChart) return; // already inited
            engineData = parseCSV(thrustCSV);
            const labels = engineData.map(d => d.t);
            const values = engineData.map(d => d.v);

            // main chart
            const ctx = document.getElementById('thrustChart').getContext('2d');
            // gradient
            const g = ctx.createLinearGradient(0,0,0,300);
            g.addColorStop(0, 'rgba(191,255,0,0.28)');
            g.addColorStop(1, 'rgba(191,255,0,0.02)');

            Chart.defaults.font.family = 'Inter, system-ui, Arial';
            Chart.defaults.color = '#e6e6e6';

            mainChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Thrust [N]',
                        data: values,
                        tension: 0.25,
                        borderColor: 'rgba(191,255,0,0.95)',
                        borderWidth: 2,
                        pointRadius: 0,
                        fill: true,
                        backgroundColor: g,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { title: { display:true, text:'Czas [s]' }, grid: { color: 'rgba(255,255,255,0.03)' } },
                        y: { title: { display:true, text:'Ciąg [N]' }, grid: { color: 'rgba(255,255,255,0.03)' } }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return ` ${context.parsed.y.toFixed(3)} N`;
                                }
                            }
                        }
                    }
                }
            });

            // small zoom chart (1.0 - 3.0 s)
            const zCtx = document.getElementById('thrustZoom').getContext('2d');
            const zoomData = engineData.filter(d => d.t >= 1.0 && d.t <= 3.0);
            const zLabels = zoomData.map(d => d.t);
            const zValues = zoomData.map(d => d.v);
            const gz = zCtx.createLinearGradient(0,0,0,260);
            gz.addColorStop(0, 'rgba(191,255,0,0.24)');
            gz.addColorStop(1, 'rgba(191,255,0,0.02)');

            zoomChart = new Chart(zCtx, {
                type: 'line',
                data: { labels: zLabels, datasets: [{ label: 'Zoom', data: zValues, borderColor: 'rgba(255,205,86,0.95)', borderWidth:2, tension:0.2, fill:true, backgroundColor:gz, pointRadius:0 }] },
                options: { responsive:true, maintainAspectRatio:false, scales:{ x:{ grid:{ color:'rgba(255,255,255,0.02)' } }, y:{ grid:{ color:'rgba(255,255,255,0.02)' } } }, plugins:{ legend:{ display:false } } }
            });

            // actions: download csv, reset zoom (simulated by re-render)
            document.getElementById('downloadCSV').addEventListener('click', () => {
                const blob = new Blob([thrustCSV], {type: 'text/csv'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url; a.download = 'thrust_profile.csv';
                document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
            });

            document.getElementById('resetZoom').addEventListener('click', () => {
                if (mainChart) mainChart.resetZoom && mainChart.resetZoom();
                // for our simple charts just update
                mainChart.update(); zoomChart.update();
            });
        }

        // accessibility: Escape to go back to shop
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (document.getElementById('page-shop-bluza').classList.contains('active') || document.getElementById('page-shop-engine').classList.contains('active')) {
                    switchPage('shop');
                }
            }
        });

    </script>

</body>
</html>
