<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>FERC | Flat Earth Rocket Corporation</title>

    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700;900&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">

    <style>
        :root {
            --accent: #bfff00;
            --bg: #000000;
            --surface: #0a0a0a;
            --text: #ffffff;
            --text-dim: #777777;
            --line: #1a1a1a;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; }
        html { scroll-behavior: smooth; }
        body {
            background: var(--bg);
            color: var(--text);
            line-height: 1.4;
            overflow-x: hidden;
        }
        body::before {
            content: "";
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://grainy-gradients.vercel.app/noise.svg');
            opacity: 0.05; pointer-events: none; z-index: 9999;
        }
        .mono { font-family: 'JetBrains Mono', monospace; color: var(--accent); font-size: 0.65rem; letter-spacing: 2px; display:block; margin-bottom:6px; }
        nav {
            position: fixed; top: 0; left: 0; right: 0;
            display:flex; justify-content:space-between; align-items:center;
            padding:22px 48px; z-index:1000;
            background: rgba(0,0,0,0.9); backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--line);
        }
        .logo { font-weight:900; font-size:1.2rem; cursor:pointer; letter-spacing:2px; }
        .logo span { color: var(--accent); }
        .nav-links { display:flex; gap:36px; }
        .nav-links a { color:#fff; text-decoration:none; text-transform:uppercase; font-weight:700; font-size:0.75rem; letter-spacing:2px; cursor:pointer; }
        .nav-links a.active, .nav-links a:hover { color: var(--accent); }

        .timer-box { border:1px solid #333; padding:10px 18px; background: rgba(10,10,10,0.8); border-radius:4px; text-align:right; }
        .timer-label { font-size:0.55rem; color:var(--accent); font-weight:700; display:block; letter-spacing:2px; }
        .timer-value { font-weight:900; font-variant-numeric:tabular-nums; }

        .hero { height: 100vh; display:flex; flex-direction:column; justify-content:center; padding:0 10%; background: radial-gradient(circle at 20% 50%, #111 0%, #000 100%); }
        .hero h1 { font-size:clamp(3rem,12vw,8rem); line-height:0.85; font-weight:900; text-transform:uppercase; letter-spacing:-3px; }

        .status-quo { padding:140px 10%; background:var(--surface); border-top:1px solid var(--line); border-bottom:1px solid var(--line); position:relative; }
        .status-quo h2 { color:var(--text-dim); font-size:clamp(1.6rem,4vw,3rem); font-weight:900; text-transform:uppercase; max-width:1000px; }

        .rocket-viewer-section { min-height:100vh; display:flex; align-items:center; padding:80px 10%; gap:40px; }
        .info-panel { flex:1; padding-right:40px; }
        .model-container { flex:1.5; height:75vh; position:relative; }

        .grid { display:grid; gap:1px; grid-template-columns:repeat(auto-fit,minmax(320px,1fr)); background:var(--line); border:1px solid var(--line); margin-bottom:60px; }
        .card { background:var(--bg); padding:36px; transition:0.25s; display:flex; flex-direction:column; align-items:flex-start; }
        .card:hover { background:#050505; }
        .card h3 { color:var(--accent); text-transform:uppercase; font-weight:900; letter-spacing:2px; margin-bottom:8px; }

        /* ---- produkt: miniaturka (bez ramki, większa) ---- */
        .product-thumb {
            height: 320px;            /* większa miniaturka */
            background: transparent;
            margin-bottom: 16px;
            position: relative;
            overflow: hidden;
            display:flex; align-items:center; justify-content:center;
            cursor:pointer;
            -webkit-tap-highlight-color: transparent;
        }
        .product-thumb img {
            position: absolute;
            height:100%;
            width:auto;
            max-width: 100%;
            object-fit: contain;
            transition: opacity 260ms ease, transform 360ms ease;
            user-select:none;
            pointer-events:none;
            display:block;
        }
        .product-thumb .img-back { opacity:0; transform: scale(0.98); }
        .product-thumb:hover .img-front { opacity:0; transform: scale(1.06); }
        .product-thumb:hover .img-back { opacity:1; transform: scale(1); }

        .price { font-family:'JetBrains Mono'; color:var(--accent); font-size:1.4rem; margin:10px 0; }
        .btn-shop { background:var(--accent); color:black; border:none; padding:10px 16px; font-weight:900; text-transform:uppercase; letter-spacing:1px; cursor:pointer; border-radius:6px; }

        /* ---- strona produktu: większy obraz, bez ramki ---- */
        .product-page { padding:110px 10% 100px; }
        .product-hero { display:flex; gap:36px; align-items:flex-start; }
        .big-image { flex:1; height:640px; background:transparent; display:flex; align-items:center; justify-content:center; overflow:hidden; }
        .big-image img { max-width:100%; max-height:100%; object-fit:contain; display:block; }

        .product-info { flex:1; padding:6px 14px; }

        .back-link { background:transparent; border:1px solid var(--line); color:var(--text-dim); padding:8px 12px; cursor:pointer; border-radius:6px; }

        footer { padding:60px 10%; border-top:1px solid var(--line); color:var(--text-dim); font-size:0.75rem; text-align:center; letter-spacing:2px; margin-top:40px; }

        @media (max-width:1024px) {
            .nav-links { display:none; }
            .rocket-viewer-section { flex-direction:column; }
            .product-hero { flex-direction:column; }
            .big-image { height:420px; width:100%; }
            .product-thumb { height:260px; }
        }
    </style>
</head>
<body>

<nav>
    <div class="logo" onclick="switchPage('home')">FERC<span>.</span></div>
    <div class="nav-links">
        <a onclick="switchPage('home')" id="link-home" class="active">Beyond the Curve</a>
        <a onclick="switchPage('missions')" id="link-missions">Missions</a>
        <a onclick="switchPage('shop')" id="link-shop">Shop</a>
    </div>
    <div class="timer-box">
        <span class="timer-label">UPCOMING LAUNCH</span>
        <span id="countdown" class="timer-value">T-00:00:00:00</span>
    </div>
</nav>

<!-- HOME -->
<div id="page-home" class="page active" style="padding-top:92px;">
    <header class="hero">
        <span class="mono">[INITIATING_CORE_SYSTEMS]</span>
        <h1>Flat Earth<br>Rocket<br><span style="color:var(--accent)">Corp</span></h1>
    </header>

    <section class="status-quo">
        <span class="mono">[MANIFESTO_v1.0]</span>
        <h2>Kwestionujemy <span style="color:white;">status quo</span> poprzez fizykę, a nie teorie. Budujemy maszyny, które dotrą tam, gdzie kończą się oficjalne narracje.</h2>
    </section>

    <section class="rocket-viewer-section">
        <div class="info-panel">
            <span class="mono">[SYSTEM_SPECIFICATIONS]</span>
            <h2 style="font-size:2.4rem; margin-bottom:12px; text-transform:uppercase; font-weight:900;">The Leveler<br>FERC-ABC</h2>
            <div style="display:flex; flex-direction:column; gap:10px;">
                <div style="display:flex; justify-content:space-between;"><span style="color:var(--text-dim)">Pułap docelowy</span><strong>250,000 FT</strong></div>
                <div style="display:flex; justify-content:space-between;"><span style="color:var(--text-dim)">Napęd</span><strong>Solid State G-Class</strong></div>
                <div style="display:flex; justify-content:space-between;"><span style="color:var(--text-dim)">Status projektu</span><strong style="color:var(--accent)">Flight Ready</strong></div>
            </div>
        </div>
        <div class="model-container">
            <model-viewer src="rakieta.glb" auto-rotate rotation-speed="40deg" shadow-intensity="2" exposure="1.2" auto-rotate-delay="0" style="width:100%; height:100%;"></model-viewer>
        </div>
    </section>

    <section class="grid" style="padding:24px 36px 60px;">
        <div class="card">
            <span class="mono">TECH_CORE</span>
            <h3>Silniki Klasy G</h3>
            <p style="color:var(--text-dim); margin-top:8px;">Nasz autorski napęd wysokoprężny zaprojektowany do stabilnego lotu w próżni niskiego pułapu. Maksymalny ciąg przy minimalnej masie.</p>
        </div>
        <div class="card">
            <span class="mono">MODULE_02</span>
            <h3>Sensory</h3>
            <p style="color:var(--text-dim); margin-top:8px;">Niezależna mechanika bezwładnościowa bez korygowania danych przez systemy zewnętrzne.</p>
        </div>
        <div class="card">
            <span class="mono">MODULE_03</span>
            <h3>Dane</h3>
            <p style="color:var(--text-dim); margin-top:8px;">Zaszyfrowany przesył w czasie rzeczywistym. Surowy plik prosto z sensora.</p>
        </div>
    </section>
</div>

<!-- MISSIONS -->
<div id="page-missions" class="page" style="padding-top:92px; display:none;">
    <section style="padding:120px 10% 80px;">
        <span class="mono">[STRATEGIC_OPERATIONS]</span>
        <h1 style="font-size:2.6rem; text-transform:uppercase; font-weight:900; margin-bottom:30px;">Operations</h1>
        <div class="grid" style="padding:20px;">
            <div class="card">
                <span class="mono">FLAGSHIP_PROJECT</span>
                <h3>Rocket Simon</h3>
                <p style="color:var(--text-dim); margin-top:8px;">Największa jednostka w historii FERC. Przełomowa konstrukcja zdolna do wyniesienia ciężkiego sprzętu optycznego na rekordowe wysokości.</p>
            </div>
            <div class="card">
                <span class="mono">ENGINEERING_DEPT</span>
                <h3>Silniki Klasy G</h3>
                <p style="color:var(--text-dim); margin-top:8px;">Proces tworzenia nowej generacji silników o zoptymalizowanym wektorowaniu ciągu.</p>
            </div>
            <div class="card">
                <span class="mono">MISSION_03</span>
                <h3>Ice Wall Recon</h3>
                <p style="color:var(--text-dim); margin-top:8px;">Długodystansowy lot w kierunku barier południowych w celu mapowania terenu.</p>
            </div>
        </div>
    </section>
</div>

<!-- SHOP MAIN -->
<div id="page-shop" class="page" style="padding-top:92px; display:none;">
    <section style="padding:120px 10% 80px;">
        <span class="mono">[COMMERCIAL_UNIT]</span>
        <h1 style="font-size:2.4rem; text-transform:uppercase; font-weight:900; margin-bottom:28px;">Gear</h1>

        <div class="grid" style="padding:18px;">
            <!-- Bluza -->
            <div class="card">
                <div class="product-thumb" role="button" tabindex="0" onclick="openProduct('bluza')" onkeydown="if(event.key==='Enter') openProduct('bluza')">
                    <img class="img-front needs-processing" data-key="bluza_przod" src="bluza_przod.png" alt="Beyond the Curve - przód" draggable="false" />
                    <img class="img-back needs-processing" data-key="bluza_tyl" src="bluza_tyl.png" alt="Beyond the Curve - tył" draggable="false" />
                </div>
                <h3>Beyond the Curve Hoodie</h3>
                <span class="price">249 PLN</span>
                <button class="btn-shop" onclick="openProduct('bluza')">Buy Gear</button>
            </div>

            <!-- Silnik -->
            <div class="card">
                <div class="product-thumb" role="button" tabindex="0" onclick="openProduct('engine')" onkeydown="if(event.key==='Enter') openProduct('engine')">
                    <img class="img-front needs-processing" data-key="g_motor" src="g_motor.png" alt="G-Class Engine - front" draggable="false" />
                    <img class="img-back needs-processing" data-key="g_motor2" src="g_motor2.png" alt="G-Class Engine - back" draggable="false" />
                </div>
                <h3>G-Class Engine Scale Model</h3>
                <span class="price">599 PLN</span>
                <button class="btn-shop" onclick="openProduct('engine')">Pre-order</button>
            </div>
        </div>
    </section>
</div>

<!-- PRODUCT BLUZA -->
<div id="page-shop-bluza" class="page" style="display:none;">
    <section class="product-page">
        <div style="max-width:1200px; margin:0 auto;">
            <button class="back-link" onclick="switchPage('shop')">← Powrót do sklepu</button>
            <div class="product-hero" style="margin-top:18px;">
                <div class="big-image">
                    <img id="bluza-big" src="bluza_przod.png" alt="Beyond the Curve - produkt" />
                </div>
                <div class="product-info">
                    <span class="mono">[PRODUCT]</span>
                    <h2 style="font-size:2.2rem; margin-bottom:8px;">Beyond the Curve Hoodie</h2>
                    <div class="price" style="font-size:1.4rem;">249 PLN</div>
                    <p style="color:var(--text-dim); margin:14px 0;">Wysokiej jakości bawełniana bluza z haftem FERC. Dostępna w rozmiarach S–XXL. Produkt limitowany.</p>
                    <div style="display:flex; gap:12px; margin-bottom:14px;">
                        <button class="btn-shop" onclick="addToCart('bluza')">Dodaj do koszyka</button>
                        <button class="btn-shop" onclick="window.alert('Symulacja zakupu — tu zaintegrujesz checkout')">Kup teraz</button>
                    </div>

                    <div style="margin-top:8px;">
                        <strong style="color:var(--text-dim); font-size:0.9rem;">Widok:</strong>
                        <div style="display:flex; gap:8px; margin-top:8px;">
                            <button class="back-link" onclick="setBigView('bluza','front')">Przód</button>
                            <button class="back-link" onclick="setBigView('bluza','back')">Tył</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- PRODUCT ENGINE -->
<div id="page-shop-engine" class="page" style="display:none;">
    <section class="product-page">
        <div style="max-width:1200px; margin:0 auto;">
            <button class="back-link" onclick="switchPage('shop')">← Powrót do sklepu</button>
            <div class="product-hero" style="margin-top:18px;">
                <div class="big-image">
                    <img id="engine-big" src="g_motor.png" alt="G-Class Engine - produkt" />
                </div>
                <div class="product-info">
                    <span class="mono">[PRODUCT]</span>
                    <h2 style="font-size:2.2rem; margin-bottom:8px;">G-Class Engine Scale Model</h2>
                    <div class="price" style="font-size:1.4rem;">599 PLN</div>
                    <p style="color:var(--text-dim); margin:14px 0;">Model silnika w skali, pre-order. Solidny detal, idealny do wystawy.</p>
                    <div style="display:flex; gap:12px; margin-bottom:14px;">
                        <button class="btn-shop" onclick="addToCart('engine')">Dodaj do koszyka</button>
                        <button class="btn-shop" onclick="window.alert('Symulacja zakupu — tu zaintegrujesz checkout')">Kup teraz</button>
                    </div>

                    <div style="margin-top:8px;">
                        <strong style="color:var(--text-dim); font-size:0.9rem;">Widok:</strong>
                        <div style="display:flex; gap:8px; margin-top:8px;">
                            <button class="back-link" onclick="setBigView('engine','front')">Przód</button>
                            <button class="back-link" onclick="setBigView('engine','back')">Tył</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<footer>
    &copy; 2026 FLAT EARTH ROCKET CORPORATION. BEYOND THE CURVE.
</footer>

<script>
/* -----------------------
   USTAWIENIA PRZETWARZANIA
   ----------------------- */
const IMAGE_KEYS = {
    'bluza_przod': 'bluza_przod.png',
    'bluza_tyl' : 'bluza_tyl.png',
    'g_motor'   : 'g_motor.png',
    'g_motor2'  : 'g_motor2.png'
};
// threshold jasności (0-255). Piksele o jasności <= THRESHOLD zostaną ustawione jako przezroczyste
const THRESHOLD = 28;

/* Mapa przechowująca przetworzone dataURL-e (transparentne) lub fallback do oryginału */
const processed = {};

/* Przetwarza obraz w canvas - usuwa czarne/prawie czarne piksele (ustawia alpha=0).
   Jeżeli obraz pochodzi z zewnętrznego źródła bez CORS, doDataURL() może zgłosić błąd -> wtedy fallback.
*/
function processImageToTransparent(src, key, threshold=THRESHOLD) {
    return new Promise((resolve) => {
        const img = new Image();
        img.crossOrigin = 'anonymous';
        img.onload = () => {
            try {
                const canvas = document.createElement('canvas');
                canvas.width = img.naturalWidth;
                canvas.height = img.naturalHeight;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0);
                const imgd = ctx.getImageData(0,0,canvas.width,canvas.height);
                const d = imgd.data;
                for (let i = 0; i < d.length; i += 4) {
                    const r = d[i], g = d[i+1], b = d[i+2];
                    const brightness = (r + g + b) / 3;
                    // jeśli piksel jest prawie czarny -> ustaw alpha 0
                    if (brightness <= threshold) {
                        d[i+3] = 0;
                    }
                }
                ctx.putImageData(imgd, 0, 0);
                const dataURL = canvas.toDataURL('image/png');
                processed[key] = dataURL;
                resolve(dataURL);
            } catch (err) {
                console.warn('Przetwarzanie obrazu nie powiodło się (możliwy problem CORS). Używam oryginału.', err);
                processed[key] = src;
                resolve(src);
            }
        };
        img.onerror = () => {
            console.warn('Błąd ładowania obrazu:', src);
            processed[key] = src;
            resolve(src);
        };
        img.src = src + (src.indexOf('?') === -1 ? '' : ''); // bez cache-bust; możesz dodać ?v=1
        // Uwaga: crossOrigin może zadziałać tylko jeśli serwer zezwala.
    });
}

/* Przetwórz wszystkie obrazy zdefiniowane w IMAGE_KEYS */
async function preprocessAll() {
    const promises = [];
    for (const key in IMAGE_KEYS) {
        promises.push(processImageToTransparent(IMAGE_KEYS[key], key));
    }
    await Promise.all(promises);
    // Po przetworzeniu: podmień miniaturki / big images
    document.querySelectorAll('.needs-processing').forEach(imgEl => {
        const key = imgEl.dataset.key;
        if (processed[key]) imgEl.src = processed[key];
    });
    // Podmień od razu duże widoki, jeśli są widoczne
    const bigBl = document.getElementById('bluza-big');
    if (bigBl && processed['bluza_przod']) bigBl.src = processed['bluza_przod'];
    const bigEn = document.getElementById('engine-big');
    if (bigEn && processed['g_motor']) bigEn.src = processed['g_motor'];
}

/* -----------------------
   Nawigacja / strony
   ----------------------- */
function switchPage(pageName) {
    document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
    document.querySelectorAll('.nav-links a').forEach(a => a.classList.remove('active'));

    // mapowanie id: 'home','missions','shop' -> elementy 'page-home' itd.
    const pageId = 'page-' + pageName;
    const el = document.getElementById(pageId);
    if (el) el.style.display = 'block';
    const link = document.getElementById('link-' + pageName);
    if (link) link.classList.add('active');
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function openProduct(key) {
    // key: 'bluza' lub 'engine'
    if (key === 'bluza') {
        switchPage('shop-bluza');
        // ustaw obraz na już przetworzony (jeśli jest)
        const big = document.getElementById('bluza-big');
        if (processed['bluza_przod']) big.src = processed['bluza_przod'];
    } else if (key === 'engine') {
        switchPage('shop-engine');
        const big = document.getElementById('engine-big');
        if (processed['g_motor']) big.src = processed['g_motor'];
    }
}

function setBigView(product, which) {
    if (product === 'bluza') {
        const el = document.getElementById('bluza-big');
        el.src = (which === 'front') ? (processed['bluza_przod'] || IMAGE_KEYS['bluza_przod']) : (processed['bluza_tyl'] || IMAGE_KEYS['bluza_tyl']);
    } else if (product === 'engine') {
        const el = document.getElementById('engine-big');
        el.src = (which === 'front') ? (processed['g_motor'] || IMAGE_KEYS['g_motor']) : (processed['g_motor2'] || IMAGE_KEYS['g_motor2']);
    }
}

/* Prosta funkcja dodania do koszyka (placeholder) */
function addToCart(item) {
    if (item === 'bluza') {
        alert('Dodano do koszyka: Beyond the Curve Hoodie');
    } else if (item === 'engine') {
        alert('Dodano do koszyka: G-Class Engine Scale Model');
    }
}

/* Escape -> wróć do sklepu z podstrony produktu */
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        if (document.getElementById('page-shop-bluza').style.display === 'block' ||
            document.getElementById('page-shop-engine').style.display === 'block') {
            switchPage('shop');
        }
    }
});

/* -----------------------
   COUNTDOWN (przykład)
   ----------------------- */
function updateCountdown() {
    const targetDate = new Date(2026, 5, 21).getTime(); // 21 czerwca 2026
    const now = Date.now();
    const d = Math.max(0, targetDate - now);
    const days = Math.floor(d / (1000*60*60*24)).toString().padStart(2,'0');
    const hours = Math.floor((d % (1000*60*60*24)) / (1000*60*60)).toString().padStart(2,'0');
    const mins = Math.floor((d % (1000*60*60)) / (1000*60)).toString().padStart(2,'0');
    const secs = Math.floor((d % (1000*60)) / 1000).toString().padStart(2,'0');
    document.getElementById('countdown').textContent = `T-${days}:${hours}:${mins}:${secs}`;
}
setInterval(updateCountdown, 1000);
updateCountdown();

/* Przy starcie: przetwórz obrazy */
document.addEventListener('DOMContentLoaded', async () => {
    await preprocessAll();
    // upewnij się, że wszystkie miniaturki mają już nowe src
    document.querySelectorAll('.product-thumb').forEach(thumb => {
        // aria role
        thumb.setAttribute('aria-label','Produkt — kliknij, aby zobaczyć szczegóły');
    });
});

/* Obsługa kliknięcia na miniaturkę (kliknięcie już z mapowaniem w HTML) - nic więcej tutaj */
</script>

<!--
 Uwaga/CORS:
 - Jeżeli obrazy są ładowane z innego serwera bez nagłówków CORS to przetwarzanie przez canvas (toDataURL) może być zablokowane.
 - W takim wypadku skrypt użyje oryginalnego pliku bez usuwania tła i wyświetli go normalnie.
 - Najpewniejsze: trzymaj obrazki obok tego pliku HTML (ta sama domena).
-->

</body>
</html>
